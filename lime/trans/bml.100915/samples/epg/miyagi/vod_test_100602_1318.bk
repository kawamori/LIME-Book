<?xml version="1.0" encoding="EUC-JP" ?>
<!DOCTYPE bml PUBLIC "-//ARIB STD-B24:1999//DTD BML Document for IPTV//JA" "http://www.arib.or.jp/B24/DTD/bml_x_x_iptv.dtd">
<?bml bml-version="100.0" ?>

<bml>
<head>
<title/>
<style><![CDATA[
	body{background-color-index:0;resolution:960x540;display-aspect-ratio:16v9;used-key-list:basic data-button numeric-tuning;clut:url(images/baria.clt);}
	p:focus{grayscale-color-index:61 56;}
	.main {left:0px; top:56px; width:960px; height:484px;}
	.clrbutton {width:140px;height:35px;}
	p.clrbutton {text-align:center;color-index:7;}
	.databutton {width:120px;height:35px;}
	p.databutton {text-align:center;color-index:0;line-height:30px;}
	.header {left:0px; top:0px; width:960px; height:56px;}
	.footer {left:0px; top:505px; width:960px; height:35px;}
	#status	{left:30px;top:80px;width:400px;height:24px;background-color-index:6;}
	p.clocktext{font-size:16px;color-index:110;grayscale-color-index:45 201;}
]]></style>

<script><![CDATA[
var gRecomend=false;
var gPlayState=false;	//フルスクリーンフラグ
 
var cnt = 0;
var stpX = 390; //停止座標
var stpTime = 200; //停止時間
var posLeft = 800; //開始座標
var time;
var i = 0; //配列変数

var list = new Array();//流すメッセージの配列
list[0]="このスクリプトは、流れる文字,ティッカーを実行します。";
list[1]="今回は流れる文字にリンクを付けました。";
list[2]="高速バス 足もとゆったりキラキラ号　東京から全国各地へ運行中";


function getElementById(id){return document.getElementById(id);}
function showElem(id){getElementById(id).normalStyle.visibility="visible";}
function hideElem(id){getElementById(id).normalStyle.visibility="hidden";}

function onloadVideo(){
	PlayVideo("http://www.hogehoge.jp:8080/test/servlet/mkmeta?cid=20101201183149461miyagi1&roll=off");
}

function scrMsg(){
//	getElementById('msgBx') = msgTxt();
	msgTxt();
	cnt++;
	if(cnt > stpTime){
		cnt = 0;
    	i++;
		if(i==list.length){i=0;}
	}
	setTimer();
}

function msgTxt() {
//var trg = 'target="_blank"';
var drift = "";
var speed = 5; //テキストの流れる速さ
var posX = posLeft-cnt*speed;     //テキストの X座標
if (posX < stpX){ posX = stpX;}   //posX が stpX(停止座標)になったらスクロールを止めます
// {drift = '<p style="position:absolute;left:' + posX +'">' + list[i] +'</p>';
{drift = '<p style="left:400">test</p>';
return drift;} 
}

function setTimer() {
time = setTimeout("scrMsg()",20);
}

function PlayVideo(URL){
	if(!URL)return;
	URL=String(URL);
	var elm=getElementById("Video");
	elm.data=URL;
	showElem("Video");
	elm.streamStatus="play";
//	showElem("ts");
	getElementById("MediaStopped").subscribe=true;
}

function VideoStop(){
	if(gRecomend){
		getElementById("MediaStopped").subscribe=false;
		show();
		gRecomend=false;
		unlockScreen();
	}else{
		getElementById("Video").streamStatus="stop";
		getElementById("MediaStopped").subscribe=false;
		hideElem("Video");
		browser.launchDocument("news.bml");
	}
}

//ウィンドウ表示に切り替える
function WindowShow(){
	gPlayState=false;
	var elm=getElementById("Video");
	elm.normalStyle.left="44px";
	elm.normalStyle.top="111px";
	elm.normalStyle.width="600px";
	elm.normalStyle.height="337px";
}

//フルスクリーン表示に切り替える
function FullShow(){
	gPlayState=true;
	var elm=getElementById("Video");
	elm.normalStyle.left="0px";
	elm.normalStyle.top="0px";
	elm.normalStyle.width="960px";
	elm.normalStyle.height="540px";
}

function focus(){
	var target = document.currentEvent.target;
	browser.playRomSound("romsound://9");
	target.nextSibling.normalStyle.visibility = "visible";
//	target.focusStyle.colorIndex = "1";
}
function blur(){
	var target = document.currentEvent.target;
	target.nextSibling.normalStyle.visibility = "hidden";
}

function click(){
	var target = document.currentEvent.target;
	var text = target.nextSibling.nextSibling.firstChild.data;
	browser.playRomSound("romsound://7");
	
	
	if(text == "メインメニュー") {
		browser.launchDocument("top.bml");
	}
	if(text == "1つ前に戻る") {
		browser.launchDocument("news.bml");
	}
	if(text == "フルスクリーン") {
		if(gPlayState) WindowShow();
		else FullShow();
	}
}

function kakudai(){
	browser.playRomSound("romsound://7");
	browser.launchDocument("news_sc.bml");
}

function menufocus(){
	var target = document.currentEvent.target;
	browser.playRomSound("romsound://9");
	target.focusStyle.colorIndex = "1";
}

function menuclick(){
	browser.playRomSound("romsound://7");
	var target = document.currentEvent.target;
	var key_id = target.id;
	if(key_id == "ch1"){
	}
	if(key_id == "ch2"){
		browser.launchDocument("play.bml");
	}
}

function DataButtonHandler(){
	browser.playRomSound("romsound://7");
	browser.launchDocument("../../lab2.sample/bml/startup.bml");
}

]]></script>

<bevent>
	<beitem id="be0" type="DataButtonPressed" onoccur="DataButtonHandler();" subscribe="subscribe"/>
	<beitem id="MediaStopped" type="MediaStopped" onoccur="VideoStop();" object_id="Video"/>
</bevent>

</head>
<body style="background-color-index:7;" onload="onloadVideo();scrMsg();">

<!-- ヘッダ -->
<div class="header">
	<object type="image/jpeg" data="images/head_meshA.jpg" style="width:1920px; height:112px"/>
</div>

<!-- メインコンテンツ -->
<div class="main">

	<!-- <object id="bg" type="image/jpeg" data="images/bg_common.jpg" style="width:960px;height:540px;"/> -->
	<object id="news" type="image/jpeg" data="images/20100531kahoku.jpg" 
		style="nav-index:0; nav-down:1; nav-left:6; nav-right:6; left:0px; top:0px; width:398px; height:450px;"
		onclick="kakudai();"/>
	
	<object id="Video" type="application/X-arib-contentPlayControl" data="" style="left:390px;top:0px;width:592px;height:333px;visibility:hidden;" streamstatus="stop"/>
	<p id="link0" style="left:900px; top:5px; width:50px; height:16px; font-size:16px;color-index:15;background-color-index:8; text-align:center; font-weight:bold;">LIVE</p>
	<p id="link0" style="left:800px; top:30px; width:150px; height:16px; font-size:16px;color-index:24;background-color-index:0; text-align:center; font-weight:bold;">今日のニュース</p>	

	<object id="ch1" type="image/jpeg" data="images/global2_02.jpg" style="left:390px;top:350px;width:110px;height:100px;"/>
	<object type="image/jpeg" data="images/global2_04.jpg" style="left:500px;top:350px;width:120px;height:100px;"/>
	<object type="image/jpeg" data="images/global2_05.jpg" style="left:620px;top:350px;width:110px;height:100px;"/>
	<object type="image/jpeg" data="images/global2_06.jpg" style="left:730px;top:350px;width:120px;height:100px;"/>
	<object type="image/jpeg" data="images/global2_03.jpg" style="left:850px;top:350px;width:110px;height:100px;"/>
	
	<div style="left:390px; top:333px; width:570px; height: 40px; color-index:7; background-color-index:0"></div>
		
</div>

<!-- フッタ(カラーボタン) -->
<div class="footer">
	<object type="image/jpeg" data="images/foot_meshA.jpg" style="width:1920px; height:70px"/>
</div>


<!--<p id="status"><![CDATA[]]></p>-->
</body>
</bml>

